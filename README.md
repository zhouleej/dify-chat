![Dify Chat](./docs/banner.png)

[![Ask DeepWiki](https://deepwiki.com/badge.svg)](https://deepwiki.com/lexmin0412/dify-chat) ![GitHub License](https://img.shields.io/github/license/lexmin0412/dify-chat) ![GitHub Created At](https://img.shields.io/github/created-at/lexmin0412/dify-chat) ![GitHub contributors](https://img.shields.io/github/contributors/lexmin0412/dify-chat) ![GitHub commit activity](https://img.shields.io/github/commit-activity/m/lexmin0412/dify-chat)![GitHub code size in bytes](https://img.shields.io/github/languages/code-size/lexmin0412/dify-chat)

**Dify Chat**ï¼Œä¸€ä¸ªåŸºäº Dify API çš„ AI Web åº”ç”¨ï¼Œæ”¯æŒå•åº”ç”¨ã€å¤šåº”ç”¨ç­‰å¤šç§æ¨¡å¼ï¼Œæä¾›å¼€ç®±å³ç”¨çš„åº”ç”¨é…ç½®ç®¡ç†åŠŸèƒ½ã€‚æ”¯æŒè¿è¡Œä¸åŒç±»å‹çš„ Dify åº”ç”¨ï¼Œé€‚é…æ·±åº¦æ€è€ƒã€æ€ç»´é“¾ã€å›¾è¡¨ç­‰å¤šç§å½¢å¼è¾“å‡ºã€‚

å¦‚æœä½ è§‰å¾—è¿™ä¸ªé¡¹ç›®è¿˜ä¸é”™çš„è¯ï¼Œè¯·åŠ¨åŠ¨ä½ çš„å°æ‰‹æŒ‡ç‚¹ä¸ª Star â­ï¸ å§ï½

| åŠ ç¾¤æ²Ÿé€šï¼ˆæéœ€æ±‚/ bug è¯·å¸¦ issue å‘è¨€ï¼‰                                                                                                              | å–‚æˆ‘èŠ±ç”Ÿï¼ˆè¯·åœ¨ç•™è¨€ä¸­å¤‡æ³¨è‡ªå·±çš„ Github ç”¨æˆ·åå“¦ï¼‰                                                                                                |
| ---------------------------------------------------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------- |
| <img src="https://github.com/user-attachments/assets/f52039d1-8232-456d-b9a6-18a9d553feb6" alt="wechat-group" style="width: 400px; height: 400px" /> | <img src="https://github.com/user-attachments/assets/f56d53b7-8529-4a1d-a0ce-27bfe60510ec" alt="sponsor" style="width: 400px; height: 400px" /> |

## ğŸ¥‡ Golden Sponsors

> æ³¨ï¼šæ¯æ—¥æ‰‹åŠ¨æ›´æ–°

| Avatar                                                                                                                          | Name                                                                          | Type   |
| ------------------------------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------- | ------ |
| <img style="width: 50px; height: 50px" src="https://avatars.githubusercontent.com/u/74965055?v=4" />                            | <a target="blank" href="https://github.com/forgoodthing">forgoodthing</a>     | Github |
| <img style="width: 50px; height: 50px" src="https://avatars.githubusercontent.com/u/18590361?v=4" />                            | <a target="blank" href="https://github.com/unmurphy">unmurphy</a>             | Github |
| <img style="width: 50px; height: 50px" src="https://avatars.githubusercontent.com/u/1463755?v=4" />                             | <a target="blank" href="https://github.com/wallowbear">æ‰“è±†è±†</a>             | Github |
| <img style="width: 50px; height: 50px" src="https://avatars.githubusercontent.com/u/9300916?v=4" />                             | <a target="blank" href="https://github.com/tangzp">tangzp</a>                 | Github |
| <img style="width: 50px; height: 50px" src="https://github.com/user-attachments/assets/2a8f706b-4c41-461c-a29c-89e354b02d33" /> | -1                                                                            | Wechat |
| <img style="width: 50px; height: 50px" src="https://avatars.githubusercontent.com/u/48902884?v=4" />                            | <a target="blank" href="https://github.com/HowieSh">HowieSh</a>               | Github |
| <img style="width: 50px; height: 50px" src="https://github.com/user-attachments/assets/77f6390a-dfb8-4660-b43d-6965477cab9b" /> | åŒ—é±¼                                                                          | Wechat |
| <img style="width: 50px; height: 50px" src="https://avatars.githubusercontent.com/u/49941899?v=4" />                            | <a target="blank" href="https://github.com/weihaoaho">weihaoaho</a>           | Github |
| <img style="width: 50px; height: 50px" src="https://github.com/user-attachments/assets/42f840cd-ce40-4193-89b7-77bd578fed5b" /> | xintan                                                                        | Wechat |
| <img style="width: 50px; height: 50px" src="https://avatars.githubusercontent.com/u/13366372?v=4" />                            | <a target="blank" href="https://github.com/zhaoweihan2015">zhaoweihan2015</a> | Github |
| None                                                                                                                            | åŒ¿åæ…ˆå–„å®¶                                                                    | Wechat |

## Repobeats

![Alt](https://repobeats.axiom.co/api/embed/cd9a078e6a4a70289aa28870d4934f6757d2fd4f.svg "Repobeats analytics image")

## ç‰¹æ€§

- ğŸ“¦ å¼€ç®±å³ç”¨ï¼šä»…éœ€ 30 ç§’é…ç½®ï¼Œå³å¯å¼€å§‹ä½¿ç”¨
- ğŸ’¬ éšå¿ƒæ‰€æ¬²ï¼šæ”¯æŒå•åº”ç”¨/å¤šåº”ç”¨æ¨¡å¼ï¼Œæ»¡è¶³ä¸åŒä¼ä¸šçº§ä¸šåŠ¡åœºæ™¯
- ğŸ’ƒ çµæ´»éƒ¨ç½²ï¼šè‡ªèº«æ— ä»»ä½•åç«¯ä¾èµ–ï¼Œå¯æ— ç¼å¯¹æ¥ Dify Cloud åŠç§æœ‰åŒ–éƒ¨ç½²çš„ API æœåŠ¡
- ğŸ“± å“åº”å¼è®¾è®¡ï¼šåŒæ—¶æ”¯æŒ PC å’Œç§»åŠ¨ç«¯ï¼ŒåŒç«¯åŠŸèƒ½åŒæ­¥
- ğŸ“ æ”¯æŒæ¸²æŸ“å›¾ç‰‡ã€è§†é¢‘ã€å›¾è¡¨ç­‰ä¸°å¯Œå†…å®¹ï¼Œè®© AI è‡ªç”±å‘æŒ¥
- ğŸ”§ é•¿æœŸç»´æŠ¤ï¼šæ—¥ç›Šå¢é•¿çš„æ´»è·ƒç¤¾ç¾¤ï¼ŒåŠ©åŠ›åŠŸèƒ½å®Œå–„

## å­åŒ…åˆ—è¡¨

| å­åŒ…åç§°                | æè¿°            | ç›¸å…³ä¿¡æ¯                                                                                                                                                                                                              | æ–‡æ¡£                                                                                         |
| ----------------------- | --------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | -------------------------------------------------------------------------------------------- |
| `@dify-chat/api`        | Dify API Client | ![version](https://img.shields.io/npm/v/@dify-chat/api) ![NPM Last Update](https://img.shields.io/npm/last-update/@dify-chat/api) ![NPM Downloads](https://img.shields.io/npm/dm/@dify-chat/api)                      | [packages/api/README.md](https://github.com/lexmin0412/dify-chat/tree/main/packages/api)     |
| `@dify-chat/core`       | æ ¸å¿ƒåŒ…          | ![version](https://img.shields.io/npm/v/@dify-chat/core) ![NPM Last Update](https://img.shields.io/npm/last-update/@dify-chat/core) ![NPM Downloads](https://img.shields.io/npm/dm/@dify-chat/core)                   | [packages/core/README.md](https://github.com/lexmin0412/dify-chat/tree/main/packages/core)   |
| `@dify-chat/theme`      | ä¸»é¢˜åŒ…          | ![version](https://img.shields.io/npm/v/@dify-chat/theme) ![NPM Last Update](https://img.shields.io/npm/last-update/@dify-chat/theme) ![NPM Downloads](https://img.shields.io/npm/dm/@dify-chat/theme)                | [packages/theme/README.md](https://github.com/lexmin0412/dify-chat/tree/main/packages/theme) |
| `@dify-chat/helpers`    | å·¥å…·åŒ…          | ![version](https://img.shields.io/npm/v/@dify-chat/helpers) ![NPM Last Update](https://img.shields.io/npm/last-update/@dify-chat/helpers) ![NPM Downloads](https://img.shields.io/npm/dm/@dify-chat/helpers)          | æ•¬è¯·æœŸå¾…...                                                                                  |
| `@dify-chat/components` | æ ¸å¿ƒ UI ç»„ä»¶åº“  | ![version](https://img.shields.io/npm/v/@dify-chat/components) ![NPM Last Update](https://img.shields.io/npm/last-update/@dify-chat/components) ![NPM Downloads](https://img.shields.io/npm/dm/@dify-chat/components) | æ•¬è¯·æœŸå¾…...                                                                                  |

## è¿è¡Œæˆªå›¾

åº”ç”¨åˆ—è¡¨ï¼š

![åº”ç”¨åˆ—è¡¨](./docs/guide__app_list.png)

ç®¡ç†åº”ç”¨é…ç½®ï¼š

![ç®¡ç†åº”ç”¨é…ç½®](./docs/guide__app_config_update.png)

å¯¹è¯å‚æ•°è®¾ç½®ï¼š

![å¯¹è¯å‚æ•°è®¾ç½®](./docs/guide__app_input_params.png)

`<think>` æ ‡ç­¾ï¼ˆDeepSeek æ·±åº¦æ€è€ƒï¼‰ï¼š

![Screen Shot](./docs/sample_think_tag.png)

Chatflow å·¥ä½œæµï¼š

![Screen Shot](./docs/sample_workflow.png)

Agent è°ƒç”¨å·¥å…·ï¼š

![Agent è°ƒç”¨å·¥å…·æˆªå›¾](./docs/guide_app_agent.png)

çŸ¥è¯†åº“å¼•ç”¨é“¾æ¥ï¼š

![Screen Shot](./docs/sample_knowledge_base_link.png)

`Echarts` å›¾è¡¨ï¼š

![Screen Shot](./docs/sample_echarts.png)

`Mermaid` å›¾è¡¨ï¼š

![Mermaid](./docs/guide__sample_mermaid.png)

æ–‡æ¡£å¤„ç†ï¼š

![æ–‡æ¡£å¤„ç†](./docs/sample_file.jpg)

å›å¤è¡¨å•ï¼š

![å›å¤è¡¨å•](./docs/guide__sample_form.png)

å•åº”ç”¨æ¨¡å¼ï¼š

![å•åº”ç”¨æ¨¡å¼](./docs/sample_single-app-mode.png)

ç§»åŠ¨ç«¯æ”¯æŒï¼š

![Screen Shot](./docs/guide__sample_mobile.png)

## æŠ€æœ¯æ ˆ

- React v18
- Ant Design v5
- Ant Design X v1
- Rsbuild v1
- Tailwind CSS v3
- TypeScript v5

## è¿è¡Œç¯å¢ƒ

å¼€å‘/ç”Ÿäº§æ„å»ºç¯å¢ƒè¦æ±‚ï¼š

- Node.js ^22.5.1
- pnpm ^10.8.1

> æ³¨æ„ï¼šæœ¬é¡¹ç›®ä½¿ç”¨äº† pnpm workspace é«˜çº§ç‰¹æ€§æ¥å®ç° Monorepo ç®¡ç†ï¼Œå…¶ä»–åŒ…ç®¡ç†å·¥å…·å¯èƒ½æ— æ³•æ­£å¸¸å·¥ä½œï¼Œè¯·å…ˆç¡®ä¿ä½ çš„ç¯å¢ƒæ»¡è¶³ä»¥ä¸Šè¦æ±‚ã€‚

## å¼€å§‹ä½¿ç”¨

**æ³¨æ„ï¼šä¸‹æ–‡å’Œæ–‡ä»¶è·¯å¾„ç›¸å…³çš„è¯´æ˜ï¼Œå‡åŸºäº packages/react-app ç›®å½•ï¼Œå¦‚ `src/App.tsx`ï¼Œå®é™…è·¯å¾„ä¸º `packages/react-app/src/App.tsx`ã€‚**

æœ¬é¡¹ç›®æ”¯æŒä¸¤ç§å¼€ç®±å³ç”¨çš„ä½¿ç”¨æ–¹å¼ï¼š

- å•åº”ç”¨æ¨¡å¼: å…¨å±€åªæœ‰ä¸€ä¸ª Dify åº”ç”¨ï¼Œç”¨æˆ·æ— éœ€é€‰æ‹©ï¼Œå¯ç›´æ¥å¼€å§‹å¯¹è¯
- å¤šåº”ç”¨æ¨¡å¼: æä¾›åº”ç”¨èšåˆåˆ—è¡¨é¡µï¼Œæ”¯æŒç”¨æˆ·é€‰æ‹©ä¸åŒçš„ Dify åº”ç”¨ï¼Œå¯æ ¹æ®ä¸šåŠ¡éœ€æ±‚çµæ´»é…ç½®

## 0. è·å– Dify åº”ç”¨é…ç½®

æ— è®ºä½¿ç”¨å“ªç§æ¨¡å¼ï¼Œæˆ‘ä»¬éƒ½éœ€è¦å¯¹æ¥ Dify APIï¼Œä½ éœ€è¦åœ¨ Dify æ§åˆ¶å°è·å–å‡ ä¸ªå…³é”®å˜é‡ï¼š

| å˜é‡     | è¯´æ˜                                                                                   |
| -------- | -------------------------------------------------------------------------------------- |
| API Base | Dify API è¯·æ±‚å‰ç¼€, å¦‚æœä½ ä½¿ç”¨çš„æ˜¯ Dify å®˜æ–¹æä¾›çš„äº‘æœåŠ¡ï¼Œåˆ™ä¸º `https://api.dify.ai/v1` |
| Api Key  | Dify API å¯†é’¥ï¼Œç”¨äºè®¿é—®å¯¹åº”åº”ç”¨çš„ API, Dify åº”ç”¨å’Œ API å¯†é’¥æ˜¯ä¸€å¯¹å¤šçš„å…³ç³»              |

è¿›å…¥ Dify çš„åº”ç”¨è¯¦æƒ…ï¼Œç‚¹å‡»å·¦ä¾§çš„ `è®¿é—® API`ï¼š

![è·å–åŸŸåå’Œå‰ç¼€](./docs/get_api_base.png)

`API æœåŠ¡å™¨` åå±•ç¤ºçš„åŸŸåå³ä¸º `API Base` å˜é‡çš„å€¼ã€‚

ç‚¹å‡»å³ä¾§çš„ `API å¯†é’¥` æŒ‰é’®ï¼Œå³å¯çœ‹åˆ° API Key çš„ç®¡ç†å¼¹çª—ï¼š

![è·å– API Key](./docs/get_api_key_entry.png)

ä½ å¯ä»¥é€‰æ‹©åˆ›å»ºä¸€ä¸ªæ–°çš„ API Keyï¼Œæˆ–è€…å¤åˆ¶ç°æœ‰çš„ API Keyã€‚

![è·å– API Key](./docs/get_api_key.png)

å®Œæˆä»¥ä¸Šæ­¥éª¤åï¼Œæˆ‘ä»¬å°†ä¼šå¾—åˆ°å¦‚ä¸‹ä¿¡æ¯ï¼š

- API Base: `https://api.dify.ai/v1` OR `${SELF_HOSTED_API_DOMAIN}/v1`
- API Key: `app-YOUR_API_KEY`

### 1. å•åº”ç”¨æ¨¡å¼

å¦‚æœä½ å…¨å±€åªéœ€è¦ä¸€ä¸ª Dify åº”ç”¨, ä¸æƒ³è®©ç”¨æˆ·æ‰‹åŠ¨ä¿®æ”¹ï¼Œå¯ä»¥ä½¿ç”¨å•åº”ç”¨æ¨¡å¼ã€‚

![å•åº”ç”¨æ¨¡å¼](./docs/sample_single-app-mode.png)

åªéœ€ç®€å•ä¿®æ”¹ `src/App.tsx` ä¸­ `DifyChatProvider` çš„å±æ€§å³å¯ï¼š

```tsx
import { AppModeEnums } from "@dify-chat/core";

export default function App() {
  return (
    <DifyChatProvider
      value={{
        // ä¿®æ”¹ä¸ºå•åº”ç”¨æ¨¡å¼
        mode: "singleApp",
        // ç”¨æˆ·idï¼Œå¯ä»¥è·å–ä¸šåŠ¡ç³»ç»Ÿçš„ç”¨æˆ· IDï¼ŒåŠ¨æ€ä¼ å…¥
        user: USER,
        // å•åº”ç”¨æ¨¡å¼ä¸‹ï¼Œéœ€è¦ä¼ å…¥ appConfig é…ç½®
        appConfig: {
          requestConfig: {
            apiBase: "ä¸Šä¸€æ­¥ä¸­è·å–åˆ°çš„ API Base",
            apiKey: "ä¸Šä¸€æ­¥ä¸­è·å–åˆ°çš„ API Key",
          },
          // å¦‚æœä½ ä½¿ç”¨çš„æ˜¯èŠå¤©ç±»å‹åº”ç”¨ (Chatbot/Chatflow/Agent), åˆ™ä¸éœ€è¦å®šä¹‰ info.mode
          info: {
            mode: AppModeEnums.WORKFLOW,
          },
        },
      }}
    >
      å­ç»„ä»¶
    </DifyChatProvider>
  );
}
```

### 2. å¤šåº”ç”¨æ¨¡å¼

å¦‚æœä½ éœ€è¦æ”¯æŒç”¨æˆ·åœ¨ç•Œé¢ä¸Šé…ç½®ä»¥åŠ/æˆ–è€…åˆ‡æ¢å¤šä¸ª Dify åº”ç”¨ï¼Œå¤šåº”ç”¨æ¨¡å¼ä¹Ÿæ˜¯å¼€ç®±å³ç”¨çš„ã€‚

#### 2.1. åœ¨ç•Œé¢ä¸Šæ·»åŠ  Dify åº”ç”¨é…ç½®

å¦‚æœä¹‹å‰æ²¡æœ‰å­˜é‡æ•°æ®ï¼Œç¬¬ä¸€æ¬¡è¿›å…¥é¡µé¢æ—¶ä¼šå±•ç¤ºç¼ºçœçŠ¶æ€ï¼Œä½ éœ€è¦ç‚¹å‡»é¡µé¢åº•éƒ¨çš„ "æ·»åŠ åº”ç”¨é…ç½®" æŒ‰é’®ï¼š

![æ·»åŠ åº”ç”¨é…ç½®æŒ‰é’®](./docs/guide_mtapp_setting.png)

æ­¤æ—¶ä¼šå¼¹å‡ºæ·»åŠ åº”ç”¨é…ç½®çš„è¡¨å•æŠ½å±‰ï¼š

![æ·»åŠ åº”ç”¨é…ç½®æŠ½å±‰](./docs/guide_mtapp_setting_add.png)

ä¾æ¬¡å¡«å…¥åº”ç”¨ä¿¡æ¯ï¼š

- è¯·æ±‚é…ç½®ï¼šåœ¨ä¸Šä¸€æ­¥ä¸­è·å–çš„ API Base å’Œ API Secret
- åº”ç”¨ç±»å‹ï¼šé»˜è®¤æ˜¯èŠå¤©åŠ©æ‰‹ï¼Œå¦‚æœæ˜¯å…¶ä»–ç±»å‹åº”ç”¨ï¼Œéœ€è¦åˆ‡æ¢åˆ°å¯¹åº”çš„ç±»å‹
- å…¶ä»–é…ç½®éå¿…éœ€ï¼Œå…ˆä¿æŒé»˜è®¤å€¼ï¼Œåç»­éœ€è¦å†ç¼–è¾‘å³å¯

![æ·»åŠ åº”ç”¨é…ç½®æŠ½å±‰-å·²å¡«å…¥ä¿¡æ¯](./docs/guide_mtapp_setting_add_fulfilled.png)

ç‚¹å‡»ç¡®å®šæŒ‰é’®ï¼Œæç¤º â€œæ·»åŠ é…ç½®æˆåŠŸâ€ï¼Œåœ¨åº”ç”¨åˆ—è¡¨ä¸­ä¼šå¤šå‡ºä¸€æ¡æ•°æ®ï¼š

![æ·»åŠ åº”ç”¨é…ç½®æˆåŠŸ](./docs/guide_mtapp_setting_add_success.png)

æ­¤æ—¶ä½ å¯ä»¥ç‚¹å‡»åº”ç”¨å¡ç‰‡å³ä¸Šè§’çš„ "æ›´å¤š" å›¾æ ‡ï¼Œå¯¹åº”ç”¨è¿›è¡Œç¼–è¾‘å’Œåˆ é™¤æ“ä½œï¼š

![åº”ç”¨å¡ç‰‡æ“ä½œ](./docs/guide_mtapp_app_actions.png)

ç‚¹å‡»åº”ç”¨å¡ç‰‡ï¼Œå³å¯è¿›å…¥åº”ç”¨è¯¦æƒ…é¡µå¼€å§‹å¯¹è¯ï¼š

![ä¸»ç•Œé¢](./docs/guide_mtapp_main.png)

#### 2.2. è‡ªå®šä¹‰åº”ç”¨é…ç½®ç®¡ç†æœåŠ¡ (æŒ‰éœ€)

**é»˜è®¤å®ç°è¯´æ˜**

ä¸ºæ–¹ä¾¿æ¼”ç¤º, æœ¬é¡¹ç›®é»˜è®¤ä½¿ç”¨ LocalStorage è¿›è¡Œåº”ç”¨é…ç½®ç®¡ç†ã€‚

ä½†å®é™…åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œç”±äºåº”ç”¨é…ç½®æ¶‰åŠ API Secret ç­‰æœºå¯†ä¿¡æ¯ï¼Œæˆ‘ä»¬ä¸€èˆ¬ä¼šå°†åº”ç”¨æ•°æ®å­˜å‚¨åœ¨æœåŠ¡ç«¯ï¼Œæ­¤æ—¶å°±éœ€è¦æ¥å…¥åç«¯æœåŠ¡æ¥å®ç°åº”ç”¨é…ç½®ç®¡ç†ã€‚

ä¸ºæ–¹ä¾¿ä½¿ç”¨æ–¹è‡ªå®šä¹‰, åº”ç”¨é…ç½®ç®¡ç†çš„æœåŠ¡æ˜¯é€šè¿‡ `src/App.tsx` ä¸­çš„ `DifyChatProvider` ç»„ä»¶æ³¨å…¥çš„:

```tsx
// src/App.tsx
import { DifyChatProvider } from "@dify-chat/core";

import DifyAppService from "./services/app/localstorage";

export default function App() {
  return (
    <DifyChatProvider
      value={{
        ...å…¶ä»–å±æ€§,
        appService: new DifyAppService(),
      }}
    >
      å­ç»„ä»¶
    </DifyChatProvider>
  );
}
```

åœ¨å­ç»„ä»¶ä¸­ï¼Œä¼šä½¿ç”¨ `useDifyChat` é’©å­è·å–åœ¨é¡¶éƒ¨æ³¨å…¥çš„ `appService` å®ä¾‹å¹¶è°ƒç”¨ç›¸å…³æ–¹æ³•å®ç°åº”ç”¨é…ç½®çš„ç®¡ç†ã€‚

**è‡ªå®šä¹‰åç«¯æœåŠ¡ç¤ºä¾‹**

åœ¨ `"./services/app/restful.ts"` æ–‡ä»¶æœ‰ä¸€ä¸ª Restful API çš„æœ€ç®€å®ç°, ä½ å¯ä»¥æ ¹æ®ä¸‹é¢çš„æ­¥éª¤æ¥è¿›è¡Œä½“éªŒï¼š

1. è¿è¡Œ `pnpm --filter dify-chat-app-server start` å¯åŠ¨åç«¯æœåŠ¡
2. å°†ä¸Šé¢çš„ `DifyAppService` å¯¼å…¥è·¯å¾„æ¢æˆ `"./services/app/restful"`
3. è¿è¡Œ `pnpm dev` å¯åŠ¨å‰ç«¯åº”ç”¨, è®¿é—® `http://localhost:5200/dify-chat`

**è‡ªå®šä¹‰åç«¯æœåŠ¡å®ç°**

å¦‚æœéœ€è¦è‡ªå®šä¹‰ä½ çš„åç«¯æœåŠ¡ï¼Œè¯·éµå¾ªä»¥ä¸‹æ­¥éª¤ï¼š

é¦–å…ˆï¼Œå‚è€ƒ `packages/server`ï¼Œå®ç°ä»¥ä¸‹æ¥å£ï¼š

- è·å– App é…ç½®åˆ—è¡¨
- è·å– App é…ç½®è¯¦æƒ…
- æ·»åŠ  App é…ç½®
- æ›´æ–° App é…ç½®
- åˆ é™¤ App é…ç½®

ç„¶ååœ¨ `src/services/app` ä¸­æ–°å»ºä¸€ä¸ªæ–‡ä»¶ï¼Œåªéœ€è¦ç»§æ‰¿æŠ½è±¡ç±» `DifyAppStore` å¹¶å®ç°å®ƒçš„æ‰€æœ‰æ–¹æ³•, è°ƒç”¨åœ¨ä¸Šè¿°æœåŠ¡ä¸­å¯¹åº”çš„æ¥å£å³å¯ã€‚

**å±•ç¤ºå›ºå®šçš„åº”ç”¨åˆ—è¡¨æ•°æ®**

å¦‚æœä½ çš„åº”ç”¨åˆ—è¡¨æ˜¯å›ºå®šä¸å˜çš„ï¼Œä¸”ä¸æƒ³é€šè¿‡åç«¯æ¥å£å®ç°ï¼Œä½ å¯ä»¥æŒ‰ç…§å¦‚ä¸‹æ­¥éª¤åœ¨ä»£ç ä¸­å®šä¹‰é™æ€é…ç½®ã€‚

é¦–å…ˆï¼Œåœ¨ `src/App.tsx` ä¸­ï¼Œä¿®æ”¹ DifyAppService çš„å¯¼å…¥è·¯å¾„ä¸º `"./services/app/static-readonly"`ï¼Œå¹¶è®¾ç½® `enableSetting` ä¸º `false`ï¼š

```tsx
// src/App.tsx
import DifyAppService from "./services/app/static-readonly";

export default function App() {
  return (
    <DifyChatProvider
      value={{
        mode: "multiApp",
        user: userId,
        appService: new DifyAppService(),
        // å›ºå®šæ•°æ®ä¸æ”¯æŒå¢åˆ æ”¹ï¼Œæ‰€ä»¥éœ€è¦ç¦ç”¨åº”ç”¨é…ç½®æƒé™
        enableSetting: false,
      }}
    >
      <LayoutIndex />
    </DifyChatProvider>
  );
}
```

ç„¶ååœ¨ `src/services/app/static-readonly/data.ts` ä¸­ï¼Œå®šä¹‰ä½ çš„åº”ç”¨åˆ—è¡¨æ•°æ®ã€‚é‡Œé¢é¢„ç½®äº†ä¸¤æ¡ç¤ºä¾‹æ•°æ®ï¼Œä½ å¯ä»¥éšæ„æ·»åŠ /ä¿®æ”¹ã€‚

> æ³¨æ„ï¼šå¦‚æœéæœ¬åœ°å¼€å‘æ¨¡å¼ï¼Œä¿®æ”¹åéœ€è¦é‡æ–°æ„å»ºæ–¹å¯ç”Ÿæ•ˆã€‚

```ts
// src/services/app/static-readonly/data.ts
import { AppModeEnums, IDifyAppItem } from "@dify-chat/core";

/**
 * é™æ€çš„åº”ç”¨åˆ—è¡¨ï¼Œç”¨äºæ¼”ç¤º
 * æ³¨æ„ï¼š**å°½é‡ä¸è¦åœ¨å…¬å¼€çš„ç”Ÿäº§ç¯å¢ƒä¸­ä½¿ç”¨é™æ€æ•°æ®**ï¼Œæ¨èä½¿ç”¨åç«¯æœåŠ¡
 */
export const staticAppList: IDifyAppItem[] = [
  {
    id: "0.270357011315995",
    info: {
      name: "My Chatflow APP",
      description: "æˆ‘çš„ Chatflow åº”ç”¨",
      tags: [],
      mode: AppModeEnums.CHATFLOW,
    },
    requestConfig: {
      apiBase: "https://api.dify.ai/v1",
      apiKey: "app-xxxxxxx",
    },
  },
  {
    id: "0.28936574761079314",
    info: {
      name: "My Workflow APP",
      description: "æˆ‘çš„ Workflow åº”ç”¨",
      tags: [],
      mode: AppModeEnums.WORKFLOW,
    },
    requestConfig: {
      apiBase: "http://127.0.0.1:5001/v1",
      apiKey: "app-xxxxxxx",
    },
  },
];
```

å…³é”®å±æ€§è¯´æ˜ï¼š

- `id`: åº”ç”¨ ID, ç”¨äºå”¯ä¸€æ ‡è¯†åº”ç”¨
- `info`: åº”ç”¨ä¿¡æ¯, åŒ…å«åº”ç”¨åç§°ã€æè¿°ã€æ ‡ç­¾ã€åº”ç”¨ç±»å‹ç­‰
  - `name`: åº”ç”¨åç§°
  - `description`: åº”ç”¨æè¿°
  - `tags`: åº”ç”¨æ ‡ç­¾ï¼Œå­—ç¬¦ä¸²æ•°ç»„
  - `mode`: åº”ç”¨ç±»å‹, ä» `AppModeEnums` æšä¸¾ä¸­é€‰æ‹©, ç›®å‰æ”¯æŒä»¥ä¸‹ç±»å‹ï¼š
    - `AppModeEnums.CHATBOT`: èŠå¤©åŠ©æ‰‹
    - `AppModeEnums.CHATFLOW`: æ”¯æŒå·¥ä½œæµç¼–æ’çš„èŠå¤©åŠ©æ‰‹
    - `AppModeEnums.AGENT`: å…·å¤‡æ¨ç†å’Œè‡ªä¸»è°ƒç”¨èƒ½åŠ›çš„èŠå¤©åŠ©æ‰‹
    - `AppModeEnums.WORKFLOW`: å·¥ä½œæµ
    - `AppModeEnums.TEXT_GENERATOR`: æ–‡æœ¬ç”Ÿæˆ
- `requestConfig`: åº”ç”¨è¯·æ±‚é…ç½®
  - `apiBase`: Dify API è¯·æ±‚å‰ç¼€
  - `apiKey`: Dify API å¯†é’¥

å®Œæˆçš„å¯é…ç½®å±æ€§è¯¦è§ï¼š[IDifyAppItem](https://github.com/lexmin0412/dify-chat/blob/main/packages/core/src/repository/app/index.ts#L6)

#### 2.3 ç¦ç”¨åº”ç”¨é…ç½®ç®¡ç†åŠŸèƒ½

å½“ä½ ä¸æƒ³è®©ç”¨æˆ·åœ¨ç•Œé¢ä¸Šç®¡ç†åº”ç”¨é…ç½®, è€Œæ˜¯ä»…æä¾›ä¸€ä¸ªåº”ç”¨åˆ—è¡¨ä¾›ç”¨æˆ·åˆ‡æ¢ï¼Œå¯ä»¥åœ¨ `src/App.tsx` ä¸­æ·»åŠ ä¸€ä¸ªé…ç½®é¡¹å³å¯ï¼š

```tsx
// src/App.tsx
import { DifyChatProvider } from "@dify-chat/core";

import DifyAppService from "./services/app/localstorage";

export default function App() {
  return (
    <DifyChatProvider
      value={{
        ...å…¶ä»–é…ç½®,
        enableSetting: false,
      }}
    >
      å­ç»„ä»¶
    </DifyChatProvider>
  );
}
```

æ­¤æ—¶ï¼Œé¡µé¢ä¸Šå°±åªä¼šå±•ç¤ºåº”ç”¨åˆ‡æ¢æŒ‰é’®, ç”¨æˆ·ä»ç„¶å¯ä»¥åˆ‡æ¢åº”ç”¨ï¼Œä½†è®¾ç½®å…¥å£è¢«éšè—ï¼š

![åº”ç”¨åˆ‡æ¢æŒ‰é’®](./docs/guide_mtapp_setting_hidden.png)

### 3. è‡ªå®šä¹‰ `sys.user_id`

åœ¨ Dify åº”ç”¨ä¸­ï¼Œå­˜åœ¨ä¸€ä¸ªåä¸º `sys.user_id` çš„å˜é‡ï¼Œç”¨äºæ ‡è¯†å½“å‰ç”¨æˆ·çš„ IDã€‚

![user_id](./docs/guide_chatflow_param_userid.jpg)

åœ¨æœ¬é¡¹ç›®ä¸­ï¼Œé»˜è®¤ä½¿ç”¨äº† `FingerPrintJS` æ¥ç”Ÿæˆæµè§ˆå™¨å”¯ä¸€çš„ç”¨æˆ· IDï¼Œä½ å¯ä»¥åœ¨ `src/App.tsx` ä¸­çœ‹åˆ°å®ƒçš„å…·ä½“å®ç°ï¼š

```tsx
import FingerPrintJS from "@fingerprintjs/fingerprintjs";

export default function App() {
  const [userId, setUserId] = useState<string>("");

  useMount(() => {
    // æ¨¡æ‹Ÿç™»å½•è¿‡ç¨‹è·å–ç”¨æˆ·å”¯ä¸€æ ‡è¯†
    const loadFP = async () => {
      const fp = await FingerPrintJS.load();
      const result = await fp.get();
      setUserId(result.visitorId);
    };
    loadFP();
  });

  return (
    <DifyChatProvider
      value={{
        // ç”¨æˆ·idï¼Œå¯ä»¥è·å–ä¸šåŠ¡ç³»ç»Ÿçš„ç”¨æˆ· IDï¼ŒåŠ¨æ€ä¼ å…¥
        user: USER,
      }}
    >
      å­ç»„ä»¶
    </DifyChatProvider>
  );
}
```

å½“ç„¶ï¼Œå¦‚æœä½ çš„ä¸šåŠ¡ç³»ç»Ÿä¸­å·²ç»æœ‰äº†ç”¨æˆ· IDï¼Œä½ å¯ä»¥è‡ªè¡Œä¿®æ”¹ `DifyChatProvider` çš„ `user` å±æ€§èµ‹å€¼é€»è¾‘ã€‚

### 4. æ”¯æŒè¡¨å•

Dify æ”¯æŒé€šè¿‡ `jinja2` æ¥é…ç½®å›å¤è¡¨å•ä¾›ç”¨æˆ·å¡«å†™ï¼Œæœ¬é¡¹ç›®ä¹Ÿæ”¯æŒäº†å¯¹åº”çš„åŠŸèƒ½ã€‚

Dify Chatflow ç¼–æ’çš„å›å¤å†…å®¹ç¤ºä¾‹ï¼š

```html
<form data-format="json">
  <label for="username">ç”¨æˆ·åå­—:</label>
  <input type="text" name="username" value="{{ username }}" />
  <label for="phone">è”ç³»ç”µè¯:</label>
  <input type="text" name="phone" value="{{ phone }}" />
  <label for="content">æŠ•è¯‰å†…å®¹:</label>
  <textarea name="content"></textarea>
  <button data-size="small" data-variant="primary">æäº¤</button>
</form>
```

> æ³¨æ„ï¼š
>
> - ä½ éœ€è¦è‡ªè¡Œåœ¨ Chatflow ä¸­å¯¹ `sys.query` è¿›è¡Œæ­£ç¡®çš„é€»è¾‘å¤„ç†ï¼ŒåŒºåˆ†æ™®é€šæ¶ˆæ¯ã€è§¦å‘è¡¨å•çš„æ¶ˆæ¯åŠæäº¤ä¿¡æ¯ã€‚
> - form æ ‡ç­¾çš„ `data-format` å±æ€§ç”¨äºæŒ‡å®šè¡¨å•æ•°æ®çš„æ ¼å¼ï¼Œç›®å‰æ”¯æŒ `json` å’Œ `text` ä¸¤ç§æ ¼å¼ã€‚

æŒ‰ç…§ä¸Šé¢çš„å†…å®¹å›å¤åï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œåœ¨ç”¨æˆ·ç‚¹å‡»è¡¨å•çš„æäº¤æŒ‰é’®åï¼Œä¼šå°†è¡¨å•çš„å€¼å¯¹è±¡ä½œä¸ºæ¶ˆæ¯å‘é€ç»™åŒä¸€ä¸ª Dify åº”ç”¨ï¼ŒåŒæ—¶ä¼šåœ¨æ¶ˆæ¯åˆ—è¡¨ä¸­å±•ç¤ºã€‚æäº¤æ¶ˆæ¯çš„ç¤ºä¾‹æ–‡æœ¬ï¼š

```json
{
  "username": "lexmin",
  "phone": "13123456789",
  "content": "å¿«é€’å¤ªæ…¢å•¦ï¼Œæˆ‘è¦ä¸¾æŠ¥",
  "isFormSubmit": true
}
```

å…¶ä¸­ï¼Œ`isFormSubmit` å­—æ®µç”¨äºæ ‡è¯†è¿™æ˜¯ä¸€ä¸ªè¡¨å•æäº¤çš„æ¶ˆæ¯, ä½ å¯ä»¥åœ¨ Chatflow ç¼–æ’çš„æ¡ä»¶åˆ†æ”¯ä¸­ä½¿ç”¨å®ƒæ¥è¿›è¡Œåˆ¤æ–­æ¶ˆæ¯ç±»å‹ã€‚

![å›å¤è¡¨å•](./docs/guide__sample_form_answer.png)

#### 4.1 è‡ªå®šä¹‰æäº¤æ¶ˆæ¯æ–‡æœ¬

å¦‚æœä½ ä¸æƒ³å±•ç¤ºå…·ä½“çš„è¡¨å•å€¼ json å­—ç¬¦ä¸²ï¼Œè€Œæ˜¯éœ€è¦è‡ªå®šä¹‰å‘é€çš„æ¶ˆæ¯æ–‡æœ¬ï¼Œå¯ä»¥æŒ‰ç…§ä¸‹é¢çš„æŒ‡å¼•ï¼Œåœ¨åº”ç”¨é…ç½®ä¸­è¿›è¡Œé…ç½®ï¼ˆæ­¤é…ç½®åªå½±å“ç•Œé¢å±•ç¤ºï¼Œå®é™…æäº¤åˆ° Dify Chatflow å¼€å§‹èŠ‚ç‚¹çš„ä»ç„¶æ˜¯ç”¨æˆ·å¡«å†™çš„è¡¨å•å€¼ json å­—ç¬¦ä¸²ï¼‰ã€‚

**å¤šåº”ç”¨æ¨¡å¼**

åœ¨æ·»åŠ /æ›´æ–°åº”ç”¨é…ç½®å¼¹çª—ä¸­å¡«å†™å­—æ®µï¼š

- è¡¨å•å›å¤ - è®¾ç½®ä¸º "å¯ç”¨"
- æäº¤æ¶ˆæ¯æ–‡æœ¬ - ç”¨äºæ›¿æ¢è¡¨å•å€¼å¯¹è±¡çš„æ–‡æœ¬ï¼Œå¦‚ "æˆ‘æäº¤äº†ä¸€ä¸ªè¡¨å•"

![å›å¤è¡¨å•-é…ç½®](./docs/guide__sample_form_answer_config.png)

**å•åº”ç”¨æ¨¡å¼**

åœ¨å…¥å£æ–‡ä»¶ä¸­ï¼Œæ·»åŠ å¯¹åº”çš„å±æ€§å³å¯ï¼š

```tsx
export default function App() {
  return (
    <DifyChatProvider
      value={{
        mode: "singleApp",
        user: USER,
        appConfig: {
          requestConfig: {
            apiBase: "ä½ çš„ API Base",
            apiKey: "ä½ çš„ API Secret",
          },
          answerForm: {
            enabled: true,
            feedbackText: "æˆ‘æäº¤äº†ä¸€ä¸ªè¡¨å•",
          },
        },
      }}
    >
      å­ç»„ä»¶
    </DifyChatProvider>
  );
}
```

æŒ‰ç…§å¦‚ä¸Šé…ç½®åï¼Œæ•ˆæœå¦‚ä¸‹ï¼š

![å›å¤è¡¨å•](./docs/guide__sample_form.png)

### 5. æ”¯æŒåº”ç”¨è¾“å…¥å‚æ•°

Dify åº”ç”¨æ”¯æŒé…ç½®åˆå§‹å‚æ•°ï¼Œåœ¨å¯¹è¯å¼€å¯æ—¶ï¼Œå±•ç¤ºåœ¨ç•Œé¢ä¸Šä¾›ç”¨æˆ·è¾“å…¥ã€‚

é»˜è®¤æƒ…å†µä¸‹ï¼ŒåŒä¸€ä¸ªå¯¹è¯åªå…è®¸è¾“å…¥ä¸€æ¬¡å‚æ•°å€¼ï¼Œåœ¨åç»­å¯¹è¯æ—¶ï¼Œå°†ä¼šç¦ç”¨è¾“å…¥æ§ä»¶ã€‚

![åº”ç”¨è¾“å…¥å‚æ•°-é»˜è®¤](./docs/sample_app_input_disabled.png)

#### 5.1 æ”¯æŒåœ¨å¯¹è¯å¼€å§‹åæ›´æ–°å‚æ•°

åœ¨åº”ç”¨é…ç½®ä¸­ï¼Œä½ å¯ä»¥é€‰æ‹©æ˜¯å¦å…è®¸ç”¨æˆ·åœ¨å¯¹è¯å¼€å§‹åæ›´æ–°å‚æ•°å€¼ï¼š

**å•åº”ç”¨æ¨¡å¼**ï¼š

å¢åŠ  `inputParams.enableUpdateAfterCvstStarts` é…ç½®é¡¹ï¼š

```tsx
export default function App() {
  return (
    <DifyChatProvider
      value={{
        ...å…¶ä»–é…ç½®,
        appConfig: {
          ...å…¶ä»–é…ç½®,
          inputParams: {
            // æ˜¯å¦å…è®¸ç”¨æˆ·åœ¨å¯¹è¯ä¸­æ›´æ–°å‚æ•°å€¼
            enableUpdateAfterCvstStarts: false,
          },
        },
      }}
    >
      å­ç»„ä»¶
    </DifyChatProvider>
  );
}
```

**å¤šåº”ç”¨æ¨¡å¼**ï¼š

åœ¨ç•Œé¢ä¸Šç¼–è¾‘åº”ç”¨é…ç½®ï¼Œå°† "å¯¹è¯å‚æ•°é…ç½®" ä¸­çš„ "æ›´æ–°å†å²å‚æ•°" è®¾ä¸º "å¯ç”¨" å³å¯ã€‚

![åº”ç”¨è¾“å…¥å‚æ•°-é…ç½®](./docs/sample_app_input_setting.png)

#### 5.2 è¯»å– URL ä½œä¸ºåº”ç”¨å‚æ•°

åœ¨å®é™…åº”ç”¨åœºæ™¯ä¸‹ï¼Œæˆ‘ä»¬å¯èƒ½æœ‰éœ€è¦åœ¨ URL ä¸­åŠ¨æ€ä¼ å…¥å‚æ•°å€¼ï¼Œå¡«å…¥è¡¨å•ã€‚

![è¯»å– URL ä½œä¸ºåº”ç”¨å‚æ•°-è¯´æ˜](./docs/sample_app_input_intro.png)

ä¸ºäº†æ”¯æŒæ­¤åŠŸèƒ½ï¼Œä½ çš„ URL éœ€è¦å®šä¹‰æˆå¦‚ä¸‹å½¢å¼ï¼š

```shell
<dify-chat-address>/dify-chat/app/<appId>?<paramName>=<encodedParamValue>&isNewCvst=1
```

#### åº”ç”¨ç¤ºä¾‹ - è®¢å•å·å¡«å…¥

é»˜è®¤æƒ…å†µä¸‹ï¼Œå¯¹è¯å‚æ•°çš„å€¼ä¸ºç©ºï¼š

![è¯»å– URL ä½œä¸ºåº”ç”¨å‚æ•°-é»˜è®¤](./docs/sample_app_input_default.jpg)

æˆ‘ä»¬å¯ä»¥åœ¨ URL ä¸­æ‹¼æ¥å‚æ•°ï¼š

```shell
http://localhost:5200/dify-chat/app/${appId}?orderNo=${encodedValue}&isNewCvst=1
```

è¯´æ˜ï¼š

- `appId`, åº”ç”¨ ID
- `encodedValue`, ç»è¿‡ `Gzip` å’Œ `encodeUriComponent` å¤„ç†åçš„å‚æ•°å€¼
- `isNewCvst`, æŒ‡å®šéœ€è¦å¼€å¯æ–°å¯¹è¯ï¼ˆå¦‚æœä¸æŒ‡å®šä¸”å­˜åœ¨å†å²å¯¹è¯æ—¶ï¼Œé»˜è®¤å°†ä¼šé€‰ä¸­æœ€è¿‘ä¸€ä¸ªå¯¹è¯ï¼‰

`encodedValue` ç”Ÿæˆæ–¹å¼ï¼ˆNodeJSï¼‰ï¼š

```javascript
const zlib = require("zlib");

const originalOrderNo = "123456";
const buffer = Buffer.from(originalString, "utf8");
let encodedValue = "";

zlib.gzip(buffer, (err, compressedBuffer) => {
  if (err) {
    console.error("å‹ç¼©æ—¶å‡ºé”™:", err);
    return;
  }
  const encodedString = compressedBuffer.toString("base64");
  encodedValue = encodeURIComponent(encodedString);
});
```

å°† `encodedValue` å¡«å…¥é“¾æ¥åè®¿é—®ï¼Œå¯ä»¥çœ‹åˆ°æˆ‘ä»¬å®šä¹‰çš„ `orderNo: 123456` å·²ç»è¢«å¡«å…¥è¡¨å•ï¼š

![è¯»å– URL ä½œä¸ºåº”ç”¨å‚æ•°-ç»“æœ](./docs/sample_app_input_filled.jpg)

### 6. å…¶ä»–é…ç½®

#### 6.1 å¼€åœºç™½

Dify åº”ç”¨æ”¯æŒé…ç½®å¼€åœºç™½ã€‚

é»˜è®¤æƒ…å†µä¸‹ï¼Œå¼€åœºç™½åœ¨æ¯ä¸ªæ–°å¯¹è¯å¼€å§‹å‰å±•ç¤ºï¼Œå½“ç”¨æˆ·å‘é€æ¶ˆæ¯ï¼ˆå³å¯¹è¯å¼€å§‹ï¼‰åï¼Œå¼€åœºç™½å°†è¢«éšè—ã€‚

å¦‚æœä½ å¸Œæœ›åœ¨å¯¹è¯å¼€å§‹åå±•ç¤ºå¼€åœºç™½ï¼Œå¯ä»¥åœ¨åº”ç”¨é…ç½®ä¸­è¿›è¡Œé…ç½®ï¼š

**å•åº”ç”¨æ¨¡å¼**ï¼š

åœ¨å…¥å£æ–‡ä»¶ä¸­ï¼Œæ·»åŠ å¯¹åº”çš„å±æ€§å³å¯ï¼š

```tsx
export default function App() {
  return (
    <DifyChatProvider
      value={{
        ...å…¶ä»–é…ç½®,
        appConfig: {
          ...å…¶ä»–é…ç½®,
          extConfig: {
            conversation: {
              openingStatement: {
                // é…ç½®å¼€åœºç™½æ€»æ˜¯å±•ç¤º
                displayMode: 'always'
              }
            }
          },
        },
      }}
    </DifyChatProvider>
  )
}
```

**å¤šåº”ç”¨æ¨¡å¼**ï¼š

åœ¨ç•Œé¢ä¸Šç¼–è¾‘åº”ç”¨é…ç½®ï¼Œå°† "å¯¹è¯é…ç½®" ä¸­çš„ "å¼€åœºç™½å±•ç¤ºåœºæ™¯" è®¾ä¸º "æ€»æ˜¯å±•ç¤º" å³å¯ã€‚

![alt text](./docs/guide_app_config_opening_statement_display_always.png)

### 7. è·¨åŸŸå¤„ç†

Dify Cloud ä»¥åŠç§æœ‰åŒ–éƒ¨ç½²çš„ Dify æœåŠ¡æœ¬èº«å‡æ”¯æŒè·¨åŸŸè¯·æ±‚ï¼Œæ— éœ€é¢å¤–å¤„ç†ï¼Œä½†å¦‚æœä½ çš„ç§æœ‰åŒ–éƒ¨ç½²ç¯å¢ƒè¿˜å­˜åœ¨é¢å¤–çš„ç½‘å…³å±‚ï¼Œä¸”å¯¹è·¨åŸŸèµ„æºè®¿é—®æœ‰ä¸¥æ ¼çš„é™åˆ¶ï¼Œå¯èƒ½å°±ä¼šå¯¼è‡´è·¨åŸŸé—®é¢˜ï¼Œå¤„ç†æ–¹å¼å¦‚ä¸‹ï¼š

åœ¨ä½ çš„ç½‘å…³å±‚çš„å“åº” Header å¤„ç†ä¸­ï¼Œå¢åŠ  `Access-Control-Allow-Origin` å­—æ®µï¼Œå…è®¸ Dify-Chat åº”ç”¨çš„éƒ¨ç½²åŸŸåè®¿é—®ï¼Œä»¥ nginx ä¸ºä¾‹ï¼š

```bash
# nginx.conf
server {
  listen 443;
  server_name dify-chat.com # è¿™é‡Œæ¢æˆä½ çš„å‰ç«¯éƒ¨ç½²åŸŸå

  location / {
    add_header Access-Control-Allow-Origin https://dify-chat.com; # è¿™é‡Œæ¢æˆä½ çš„å‰ç«¯éƒ¨ç½²åè®®+åŸŸå
    add_header Access-Control-Allow-Methods 'GET, POST, PUT, DELETE, OPTIONS';
  }
}
```

## æœ¬åœ°å¼€å‘

å®‰è£…ä¾èµ–:

```bash
pnpm install
```

å¯åŠ¨å¼€å‘æœåŠ¡å™¨ï¼š

> æ”¯æŒå­åŒ…çƒ­æ›´æ–°ï¼Œæ— éœ€æå‰æ„å»º

```bash
pnpm dev
```

æ„å»ºç”Ÿäº§ç‰ˆæœ¬ï¼š

```bash
pnpm build
```

é¢„è§ˆç”Ÿäº§ç‰ˆæœ¬ï¼š

```bash
pnpm preview
```

## å®¹å™¨è¿è¡Œ

è¿›å…¥dockerç›®å½•å¯åŠ¨å®¹å™¨ç¼–æ’ï¼š

```bash
docker compose up dify-chat -d
```

æµè§ˆå™¨è®¿é—®http://127.0.0.1:8080/dify-chat/

å®¹å™¨é»˜è®¤æš´éœ²httpç«¯å£8080ï¼Œhttpsç«¯å£8443ï¼Œå¯ä¿®æ”¹.envæ–‡ä»¶é…ç½®ç¯å¢ƒå˜é‡

é»˜è®¤é…ç½®çš„dockeré•œåƒä¸ºå¤šåº”ç”¨æ¨¡å¼ï¼Œå¦‚éœ€è‡ªå®šä¹‰ä½¿ç”¨ï¼ˆå¦‚å•åº”ç”¨æ¨¡å¼ï¼‰è¯·è‡ªè¡Œæ„å»ºdockeré•œåƒ

## ä½¿ç”¨certbotå…¨è‡ªåŠ¨ç­¾å‘letsencryptå…è´¹sslè¯ä¹¦

åœ¨æ“ä½œä¹‹å‰è¯·ç¼–è¾‘.envæ–‡ä»¶ä¿®æ”¹ä»¥ä¸‹å‡ ä¸ªå‚æ•°ï¼š

```bash
NGINX_HTTPS_ENABLED=true
#åŸŸå
NGINX_SERVER_NAME
#å¾…ç”³è¯·è¯ä¹¦çš„åŸŸå
CERTBOT_DOMAIN
NGINX_ENABLE_CERTBOT_CHALLENGE=true
#åŸŸåé‚®ç®±ï¼Œéšä¾¿å†™
CERTBOT_EMAIL
#æ›´å¤šè¯ä¹¦ç”³è¯·å‚æ•°ï¼Œå¯ç•™ç©º
CERTBOT_OPTIONS
```

> æ³¨æ„ï¼šè¯·ç¡®ä¿ä½ é…ç½®çš„åŸŸåå¯ä»¥ä½¿ç”¨80ç«¯å£è®¿é—®åˆ°ä½ çš„ dify-chat ç«™ç‚¹ï¼Œè¯¦è§ï¼šhttps://eff-certbot.readthedocs.io/en/latest/install.html#alternative-1-docker

åœ¨dockerç›®å½•æ‰§è¡Œå‘½ä»¤å³å¯å…¨è‡ªåŠ¨ç”³è¯·ã€ç­¾å‘è¯ä¹¦ï¼š

```bash
docker-compose --profile certbot up
```

ç­¾å‘çš„è¯ä¹¦åœ¨[docker/certbot/conf/live/ä½ çš„åŸŸå]ç›®å½•ä¸‹ã€‚

æ³¨æ„ï¼šä»¥ä¸Šè·¯å¾„çš„è¯ä¹¦æ–‡ä»¶ä¸ºæ›¿èº«ï¼Œå¦‚éœ€å°†è¯ä¹¦ç”¨åœ¨å…¶ä»–é¡¹ç›®ä¸Šéœ€è¦åœ¨[docker/certbot/conf/archive/ä½ çš„åŸŸå]ç›®å½•ä¸‹è·å–çœŸå®è¯ä¹¦æ–‡ä»¶

```txt
`privkey.pem`  : the private key for your certificate.
`fullchain.pem`: the certificate file used in most server software.
`chain.pem`    : used for OCSP stapling in Nginx >=1.3.7.
`cert.pem`     : will break many server configurations, and should not be used
                 without reading further documentation (see link below).
```

![æ³¨æ„ï¼šè¯ä¹¦éœ€è¦å®šæœŸç»­æœŸ]

## FAQ

A: pnpm install æŠ¥é”™ `Cannot find matching keyid: ${JSON.stringify({ signatures, keys })}`

Q: å…ˆè¿è¡Œ `COREPACK_INTEGRITY_KEYS=0 corepack prepare` å†æ‰§è¡Œ `pnpm install`ã€‚

## Roadmap

- [x] æ”¯æŒå¤šä¸ªä¼šè¯åˆ‡æ¢
- [x] æ”¯æŒè¿è¡Œæ—¶ç”¨æˆ·è‡ªå®šä¹‰ Dify API é…ç½®
- [x] ç§»åŠ¨ç«¯é€‚é…
- [x] æ¶ˆæ¯æ›´æ–°æ—¶è‡ªåŠ¨æ»šåŠ¨åˆ°æœ€åº•éƒ¨
- [x] æ‹†åˆ†ç‹¬ç«‹ç»„ä»¶åº“ï¼Œæ–¹ä¾¿äºŒæ¬¡å¼€å‘
- [x] ä¼šè¯æ“ä½œ
  - [x] æ”¯æŒä¼šè¯é‡å‘½å
- [x] å¯¹è¯å‚æ•°è®¾ç½®
  - [x] æ”¯æŒä¿®æ”¹å¯¹è¯å‚æ•°
- [x] æ¶ˆæ¯å‘é€åŒºåŸŸåŠŸèƒ½
  - [x] æ”¯æŒå‘é€å›¾ç‰‡
  - [x] æ”¯æŒå‘é€å…¶ä»–ç±»å‹çš„æ–‡ä»¶
  - [x] æ”¯æŒæ‰“æ–­è¾“å‡º
  - [x] æ”¯æŒè¯­éŸ³è¾“å…¥è½¬æ–‡å­—
- [x] æ¶ˆæ¯å†…å®¹æ¸²æŸ“
  - [x] æ”¯æŒæ·±åº¦æ€è€ƒæ ‡ç­¾å±•ç¤ºï¼ˆå¦‚ DeepSeek-R1 çš„è¾“å‡ºï¼‰
  - [x] æ”¯æŒå·¥ä½œæµä¿¡æ¯å±•ç¤º
  - [x] æ”¯æŒæ€ç»´é“¾å±•ç¤º
  - [x] æ”¯æŒçŸ¥è¯†åº“å¼•ç”¨åˆ—è¡¨å±•ç¤º
  - [x] æ”¯æŒå›¾ç‰‡å±•ç¤º
  - [x] æ”¯æŒå›¾ç‰‡æ”¾å¤§æŸ¥çœ‹
  - [x] æ”¯æŒ `Echarts` æ¸²æŸ“
  - [x] æ”¯æŒæ•°å­¦å…¬å¼æ¸²æŸ“
  - [x] æ”¯æŒæ–‡ä»¶å¡ç‰‡æ¸²æŸ“
  - [x] æ”¯æŒ `Mermaid` æ¸²æŸ“
  - [x] æ”¯æŒå›¾ç‰‡/è§†é¢‘
- [x] æ¶ˆæ¯å†…å®¹äº¤äº’
  - [x] æ”¯æŒå†…å®¹å¤åˆ¶
  - [x] æ”¯æŒç‚¹èµ/ç‚¹è¸©
  - [x] æ”¯æŒæ¶ˆæ¯æ–‡ä»¶ç‚¹å‡»ä¸‹è½½
  - [x] æ”¯æŒå›å¤è¡¨å•å±•ç¤ºå’Œæäº¤
  - [x] æ”¯æŒæ–‡å­—è½¬è¯­éŸ³
- [x] æ”¯æŒå¤šåº”ç”¨æ¨¡å¼
  - [x] Localstorage å®ç°
  - [x] Restful API å®ç°
  - [x] æ”¯æŒè‡ªå®šä¹‰åç«¯æœåŠ¡
  - [x] é…ç½®å’Œåˆ‡æ¢åŠŸèƒ½åˆ†ç¦»ï¼Œæ”¯æŒéšè—é…ç½®å…¥å£
- [x] æ”¯æŒå•åº”ç”¨æ¨¡å¼
  - [ ] æ”¯æŒç”¨æˆ·åœ¨ç•Œé¢ä¸Šå˜æ›´é…ç½®
- [x] å­åŒ…å‘å¸ƒ
  - [x] å‘å¸ƒ `@dify-chat/core` åŒ…
  - [x] å‘å¸ƒ `@dify-chat/helpers` åŒ…
  - [x] å‘å¸ƒ `@dify-chat/api` åŒ…
  - [x] å‘å¸ƒ `@dify-chat/components` åŒ…
- [ ] å›½é™…åŒ–
- [ ] æ”¯æŒå•ä¸ªä¼šè¯è§†å›¾
- [ ] æ”¯æŒæ¶ˆæ¯è§¦é¡¶/è§¦åº•è‡ªåŠ¨åˆ†é¡µåŠ è½½
- [x] æ”¯æŒå›å¤é‡æ–°ç”Ÿæˆ
- [x] æ”¯æŒå¤œé—´æ¨¡å¼
- [ ] æ”¯æŒè‡ªå®šä¹‰ä¸»é¢˜
- [ ] è¡¥å……ä¸åŒç±»å‹åº”ç”¨åœºæ™¯çš„æœ€ä½³å®è·µ
- [ ] å®¹å™¨åŒ–éƒ¨ç½²æ”¯æŒ

## License

[MIT](./LICENSE)

## Star History

[![Star History Chart](https://api.star-history.com/svg?repos=lexmin0412/dify-chat&type=Date)](https://www.star-history.com/#lexmin0412/dify-chat&Date)
